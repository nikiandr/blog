---
  import { type CollectionEntry, getCollection } from "astro:content";
  import GalleryWrapper from "../../components/GalleryWrapper.astro";
  import AlbumLayout from "../../layouts/album-layout.astro";

  export async function getStaticPaths() {
    const allAlbums = await getCollection(
      "albums",
      ({ data }) => import.meta.env.DEV || !data.draft
    );

    return allAlbums.map((albumEntry) => ({
      params: { album: albumEntry.id.split("/")[0] },
      props: { album: albumEntry },
    }));
  }

  type Props = {
    album: CollectionEntry<"albums">;
  };

  const { album } = Astro.props;
  const { title, description, tripDates, photos } = album.data;

  const formatDate = (date: Date) =>
    date.toLocaleDateString("en-US", {
      year: "numeric",
      month: "long",
      day: "numeric",
    });

  const tripStart = formatDate(tripDates[0]);
  const tripEnd = formatDate(tripDates[1]);
  const dateRange = `${tripStart} â€” ${tripEnd}`;

  const pageTitle = `${title} | Photos | Nikita Fordui`;
---
<AlbumLayout
  title={pageTitle}
  albumTitle={title}
  description={description}
  dateRange={dateRange}
  photoCount={photos.length}
>
  <GalleryWrapper images={photos} class="not-prose"/>
</AlbumLayout>
